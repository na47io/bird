<div id="<%= dom_id post %>">
</div>
<div class="post">
  <div class="post-header">
    <div class="post-meta">
      <div class="author-section">
        <div class="profile-image"></div>
        <div class="author-details">
          <div class="author"><%= post.author %></div>
          <div class="timestamp"><%= time_ago_in_words(post.created_at) %> ago</div>
        </div>
      </div>
    </div>
    <button class="reply-button" onclick="document.getElementById('reply-dialog-<%= post.id %>').showModal()">Reply</button>
  </div>
  
  <div class="post-content">
    <div class="body"><%= highlight_hashtags(post.body) %></div>
    <% if post.hash_tags.any? %>
      <div class="tags">
        <% post.hash_tags.each do |tag| %>
          <span class="tag"><%= tag.name %></span>
        <% end %>
      </div>
    <% end %>
  </div>
  
  <% if post.replies.any? %>
    <div data-controller="replies" 
         data-replies-count-value="<%= post.replies.count %>"
         data-replies-search-value="<%= @query.present? %>">
      <button 
        data-action="replies#toggle" 
        data-replies-target="count"
        class="replies-toggle">
        Hide replies
      </button>
      
      <div class="replies" data-replies-target="replies">
      <% post.replies.each do |reply| %>
        <div class="reply">
          <div class="author-section">
            <div class="profile-image"></div>
            <div class="author-details">
              <div class="author"><%= reply.author %></div>
              <div class="timestamp"><%= time_ago_in_words(reply.created_at) %> ago</div>
            </div>
          </div>
          <div class="body"><%= reply.body %></div>
        </div>
      <% end %>
      </div>
    </div>
  <% end %>
  
  <dialog id="reply-dialog-<%= post.id %>" class="reply-dialog">
    <%= form_for [post, Reply.new], html: { class: "reply-form" } do |f| %>
      <div class="dialog-header">
        <button type="button" class="cancel-button" onclick="this.closest('dialog').close()">Cancel</button>
        <%= f.submit "Post", class: "post-submit-button" %>
      </div>
      
      <div class="dialog-content">
        <div class="profile-image"></div>
        <div class="input-area">
          <%= f.text_field :author, placeholder: "Your name", class: "author-input" %>
          <%= f.text_area :body, placeholder: "What's up?", class: "body-input" %>
        </div>
      </div>
      
      <div class="dialog-footer">
        <div class="visibility-info">
          <span class="globe-icon">ğŸŒ</span>
          <span>Anybody can interact</span>
        </div>
        
        <div class="dialog-tools">
          <div class="media-tools">
            <button type="button" class="tool-button">ğŸ–¼ï¸</button>
            <button type="button" class="tool-button">ğŸ¥</button>
            <button type="button" class="tool-button">GIF</button>
            <button type="button" class="tool-button">ğŸ˜Š</button>
          </div>
          <div class="post-meta-tools">
            <select class="language-select">
              <option>English</option>
            </select>
            <span class="character-count">300</span>
          </div>
        </div>
      </div>
    <% end %>
  </dialog>
</div>
